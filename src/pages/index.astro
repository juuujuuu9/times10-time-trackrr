---
import Layout from '../layouts/Layout.astro';
import Timer from '../components/Timer';
import { getSessionUser } from '../utils/session';

// Check if user is logged in
const user = await getSessionUser(Astro);

// If logged in, redirect to appropriate dashboard
if (user) {
  if (user.role === 'admin') {
    return Astro.redirect('/admin');
  } else if (user.role === 'manager') {
    return Astro.redirect('/manager');
  } else {
    return Astro.redirect('/dashboard');
  }
}
---

<Layout title="Times10 Time Tracker">
	<main class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
		<div class="text-center">
			<h1 class="text-6xl font-bold text-gray-800 mb-4">
				Times10 Time Tracker
			</h1>
			<p class="text-xl text-gray-600 mb-8">
				Welcome to your productivity companion
			</p>
			<div class="space-x-4 mb-8">
				<a href="/login" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors inline-block">
					Sign In
				</a>
				<a href="/setup" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors inline-block">
					Setup Demo Users
				</a>
				<a href="/admin" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors inline-block">
					Admin Dashboard
				</a>
			</div>
			<div class="mb-8">
				<div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg">
					<strong>âœ… Database Connected!</strong> Your Neon PostgreSQL database is ready for time tracking.
				</div>
			</div>
			<Timer client:load />
		</div>
	</main>
</Layout>
<style>
	main {
  background: linear-gradient(-45deg, #2d24ff, #5546ff, #1ED9BD, #57FF65, #fc7eff, #a400a7);
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
}

@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
</style>